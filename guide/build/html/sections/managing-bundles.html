<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>15. Managing Bundles &mdash; The Gort Guide 0.9 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="16. Command Execution Rules" href="command-execution-rules.html" />
    <link rel="prev" title="14. Installing Your First Command Bundle" href="installing-your-first-command-bundle.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> The Gort Guide
          </a>
              <div class="version">
                0.9.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">1. Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">2. Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">3. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">4. Configuring Gort</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">5. Deploying Gort</a></li>
<li class="toctree-l1"><a class="reference internal" href="bootstrapping.html">6. Bootstrapping Gort</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands-and-bundles.html">7. Commands and Bundles</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands-as-containers.html">8. Commands As Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-environment-variables.html">9. Command Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="command-bundles.html">10. Command Bundles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bundle-configurations.html">11. Bundle Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="permissions-and-rules.html">12. Permissions and Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing-a-command-bundle.html">13. Writing a Command Bundle</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing-your-first-command-bundle.html">14. Installing Your First Command Bundle</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">15. Managing Bundles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">15.1. Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-bundles">15.2. Installing Bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-bundle-configuration-file">15.3. The Bundle Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enabling-and-disabling-bundle-versions">15.4. Enabling and Disabling Bundle Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uninstalling-bundles-and-bundle-versions">15.5. Uninstalling Bundles and Bundle Versions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#uninstalling-a-bundle-version">15.5.1. Uninstalling a bundle version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uninstalling-all-versions-of-a-bundle">15.5.2. Uninstalling all versions of a bundle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command-execution-rules.html">16. Command Execution Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">17. Output Format Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates-response-envelope.html">18. The Response Envelope</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates-functions.html">19. Template Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="going-forward.html">20. Going Forward: Features to Look Forward To</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Gort Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">15. </span>Managing Bundles</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/sections/managing-bundles.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="managing-bundles">
<h1><span class="section-number">15. </span>Managing Bundles<a class="headerlink" href="#managing-bundles" title="Permalink to this headline"></a></h1>
<p>This document details the commands used to manage bundles.</p>
<p>Currently, all command bundles are executed on the same machine as the
Gort Controller. In <a class="reference external" href="going-forward.md">a future release</a>, support for
“relays” will be added, which will allow commands to be executed on
different machines running a Relay process.</p>
<!-- All command bundles (with the exception of the embedded `gort` bundle) run under one or more Relay processes, which can be on the same machine as the Gort bot or on different machines.

To learn more about bundles or relays check out the corresponding docs. --><section id="prerequisites">
<h2><span class="section-number">15.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h2>
<p>For simplicity we will be using the <code class="docutils literal notranslate"><span class="pre">gort</span></code> command-line utility to
demonstrate bundle management. Bundle management mostly involves use of
the <code class="docutils literal notranslate"><span class="pre">bundle</span></code> subcommand. However, you aren’t explicitly required to
use <code class="docutils literal notranslate"><span class="pre">gort</span></code> to manage bundles: you can use the <code class="docutils literal notranslate"><span class="pre">!gort:bundle</span></code>
command, or you can even make calls directly to the API if you like.</p>
<p>The remainder of this page assumes that you have a working Gort
Controller and the <code class="docutils literal notranslate"><span class="pre">gort</span></code> utility.</p>
</section>
<section id="installing-bundles">
<h2><span class="section-number">15.2. </span>Installing Bundles<a class="headerlink" href="#installing-bundles" title="Permalink to this headline"></a></h2>
<p>Bundles are installed by uploading bundle configurations to Gort, which
then registers the bundle. Registration includes the creation of the
permissions declared by the bundle, as well as any default rules
specified in the bundle’s metadata.</p>
<p>Importantly, after installation your bundle command will be available,
but may not be usable yet. Before anyone can execute the new commands,
make sure their user permissions are set properly. See <a class="reference external" href="permissions-and-rules.md">Permissions and
Rules</a> to learn more.</p>
<p>Bundles are installed via the <code class="docutils literal notranslate"><span class="pre">bundle</span> <span class="pre">install</span></code> sub-command in
<code class="docutils literal notranslate"><span class="pre">gort</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle install --help
Install a bundle from a bundle file.

When using this command, you must provide the path to the file, as follows:

  gort bundle install /path/to/my/bundle/config.yaml

Usage:
  gort bundle install [flags] config_path

Flags:
  -h, --help   Show this message and exit

Global Flags:
  -P, --profile string   The Gort profile within the config file to use
</pre></div>
</div>
</section>
<section id="the-bundle-configuration-file">
<h2><span class="section-number">15.3. </span>The Bundle Configuration File<a class="headerlink" href="#the-bundle-configuration-file" title="Permalink to this headline"></a></h2>
<p>The only required argument for <code class="docutils literal notranslate"><span class="pre">gort</span> <span class="pre">bundle</span> <span class="pre">install</span></code> is the path to
the bundle’s config file.</p>
<p>All bundles have a <code class="docutils literal notranslate"><span class="pre">config</span></code> file, a yaml-formatted document that
contains information for installing and executing commands in your
bundle. To learn more about configuration files take a look at <a class="reference external" href="bundle-configurations">Bundle
Configurations</a>.</p>
<p>We won’t discuss bundle configurations in detail here, but minimally
each must contain:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - The name of your bundle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code> - The version of your bundle in semver format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gort_bundle_version</span></code> - The version of the config file format
(currently only version 1 is used).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">commands</span></code> - A map of commands to be included in the bundle.</p></li>
</ul>
<p>A minimal bundle config might look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
<span class="n">gort_bundle_version</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">name</span><span class="p">:</span> <span class="n">my_bundle</span>
<span class="n">version</span><span class="p">:</span> <span class="mf">0.0.1</span>
<span class="n">description</span><span class="p">:</span> <span class="n">My</span> <span class="n">bundle</span>
<span class="n">commands</span><span class="p">:</span>
  <span class="n">date</span><span class="p">:</span>
    <span class="n">executable</span><span class="p">:</span> <span class="p">[</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">date</span> <span class="p">]</span>
    <span class="n">rules</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">allow</span>
</pre></div>
</div>
<p>The command to install the bundle would be something like
<code class="docutils literal notranslate"><span class="pre">gort</span> <span class="pre">bundle</span> <span class="pre">install</span> <span class="pre">/path/to/my_bundle.yml</span></code>.</p>
<p><strong>Note: bundles are disabled when first installed. You must enable it
before use.</strong></p>
<!-- ## Templates

The templates flag points to a directory containing any templates for your bundle.

Templates are used by Gort to format command output. They are singular to a specific command/adapter combo. So for example; if we wanted to support both HipChat and Slack for our date command, we would need to supply two templates.

When added to the config file the templates section might look something like this:

---
...
templates:
  date:
    body: |
      ~each var=$results~
      `~$item.date~`
      ~end~
...
This works great for simple templates, but can get confusing when things start to get more complicated. To remedy that gort provides some helpers.

If you store your templates in a directory, you'll need to pass the --templates option; gort does not infer this by default. The directory should contain one directory per adapter and each adapter directory should contain a mustache file for each command. So for our date command we would have something like this:

$ tree templates
templates
└── date.greenbar
Given a structure like this gort will automatically append all of the templates in the directory to your bundle config before uploading. --></section>
<section id="enabling-and-disabling-bundle-versions">
<h2><span class="section-number">15.4. </span>Enabling and Disabling Bundle Versions<a class="headerlink" href="#enabling-and-disabling-bundle-versions" title="Permalink to this headline"></a></h2>
<p>When a new version of a bundle is installed, it’s disabled by default.
Only one version can be enabled at a time and a version must be
explicitly enabled before Gort will use it to handle commands.</p>
<p>Enabling and disabling bundle versions is a straight-forward process.</p>
<p>For example, if you already have version 1.0.0 of “my-bundle” installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ go run . bundle versions my-bundle
BUNDLE      VERSION    STATUS
my-bundle   1.0.0      Enabled
</pre></div>
</div>
<p>You can install version 2.0.0 in a reasonably straight-forward manner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle install /path/to/my-bundle/v2/config.yaml
$ gort bundle versions my-bundle
BUNDLE      VERSION    STATUS
my-bundle   1.0.0      Enabled
my-bundle   2.0.0      Disabled
</pre></div>
</div>
<p>As always, a newly-installed bundle is disabled by default. At this
point, invoking any commands from the “my-bundle” bundle will still
execute from version 1.0.0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle info my-bundle
Name: gort
Versions: 1.0.0, 2.0.0
Status: Enabled
Enabled Version: 1.0.0
Commands: date
Permissions:
</pre></div>
</div>
<p>Switching to the new version is as simple as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle enable my-bundle 2.0.0
$ gort bundle versions my-bundle
BUNDLE      VERSION    STATUS
my-bundle   1.0.0      Disabled
my-bundle   2.0.0      Enabled
</pre></div>
</div>
<p>From now on, any “my-bundle” command invocations will execute from
version 2.0.0, using whatever access rules have been defined in that
version.</p>
<p>And if you decide you don’t like version 2.0.0 for any reason, you can
always switch back to 1.0.0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle enable my-bundle 1.0.0
$ gort bundle versions my-bundle
BUNDLE      VERSION    STATUS
my-bundle   1.0.0      Enabled
my-bundle   2.0.0      Disabled
</pre></div>
</div>
<p>Assuming that you have the required access, you can also enable and
disable bundles using the <code class="docutils literal notranslate"><span class="pre">gort:bundle</span></code> chat command.</p>
<!-- ### Relay Groups
Gort manages all of your command bundles and relays. Bundles are associated to relays via relay-groups. When a bundle is installed and assigned to a relay-group, Gort pushes the command config to the appropriate relay or relays. When a command is invoked, Gort uses the relay-group to select which relay is capable of running which command.

Relay groups are managed through gort with the relay-group sub-command. For more information read up on Installing and Managing Relays.

Optionally during bundle creation you can pass the --relay-group option multiple times.

Bundles are assigned to relays via relay groups using gort.

$ gort relay-group assign my_relay_group my_bundle
Note

The default refresh interval for a relay is 15 minutes (set in the relay configuration file - relay.conf). Be sure to wait for the specified amount time in order to see the bundle appear on the relays in the assigned relay group. --></section>
<section id="uninstalling-bundles-and-bundle-versions">
<h2><span class="section-number">15.5. </span>Uninstalling Bundles and Bundle Versions<a class="headerlink" href="#uninstalling-bundles-and-bundle-versions" title="Permalink to this headline"></a></h2>
<p>You may uninstall a specific version of a bundle or all versions of a
bundle.</p>
<p>Uninstalling a specific version will remove rules and permissions only
associated with that version. Uninstalling all bundle versions involves
complete removal of all authorization rules governing its commands as
well as deletion of all the bundle’s permissions. You can re-install to
restore the bundle permissions and rules. If you only wish to disable a
bundle, see “Enabling and Disabling Bundle Versions” above.</p>
<p>Uninstalling a bundle requires the use of the <code class="docutils literal notranslate"><span class="pre">gort</span> <span class="pre">bundle</span> <span class="pre">uninstall</span></code>
subcommand.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle uninstall --help
Uninstall bundles.

Usage:
  gort bundle uninstall [flags] bundle_name version

Flags:
  -c, --clean         Uninstall all disabled bundle versions
  -x, --incompatible  Uninstall all incompatible versions of the bundle
  -a, --all           Uninstall all versions of the bundle
  --help              Show this message and exit.

Global Flags:
  -P, --profile string   The Gort profile within the config file to use
</pre></div>
</div>
<section id="uninstalling-a-bundle-version">
<h3><span class="section-number">15.5.1. </span>Uninstalling a bundle version<a class="headerlink" href="#uninstalling-a-bundle-version" title="Permalink to this headline"></a></h3>
<p>Importantly, enabled bundles cannot be uninstalled.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle uninstall date 0.1.0
Usage: gort bundle uninstall [OPTIONS] NAME [VERSION]

Error: Invalid value for &quot;version&quot;: Cannot uninstall enabled version. Please disable the bundle first
</pre></div>
</div>
<p>Before any bundle can be uninstalled, it must first be disabled.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle disable my_bundle 0.1.0
$ gort bundle uninstall my_bundle 0.1.0
Uninstalled my_bundle 0.1.0
</pre></div>
</div>
</section>
<section id="uninstalling-all-versions-of-a-bundle">
<h3><span class="section-number">15.5.2. </span>Uninstalling all versions of a bundle<a class="headerlink" href="#uninstalling-all-versions-of-a-bundle" title="Permalink to this headline"></a></h3>
<p>Since uninstalling all versions of a bundle can be very destructive, you
must pass the <code class="docutils literal notranslate"><span class="pre">--all</span></code> flag to <code class="docutils literal notranslate"><span class="pre">gort</span></code>, or your request will fail.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle uninstall date
Error: Can&#39;t uninstall without specifying a version, or --incompatible, --all, --clean
</pre></div>
</div>
<p>It would seem that <code class="docutils literal notranslate"><span class="pre">gort</span> <span class="pre">bundle</span> <span class="pre">uninstall</span></code> needs either a version
number, or an <code class="docutils literal notranslate"><span class="pre">--all</span></code> flag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle uninstall date --all
Usage: gort bundle uninstall [OPTIONS] NAME [VERSION]

Error: date 0.1.0 is currently enabled. Please disable the bundle first.
</pre></div>
</div>
<p>This time the uninstallation failed because the bundle is still enabled.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gort bundle disable date
Disabled date

$ gort bundle uninstall date --all
Uninstalled date 0.0.1
Uninstalled date 0.0.1
Uninstalled date 0.1.0
</pre></div>
</div>
<p>Success at last.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installing-your-first-command-bundle.html" class="btn btn-neutral float-left" title="14. Installing Your First Command Bundle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="command-execution-rules.html" class="btn btn-neutral float-right" title="16. Command Execution Rules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, The Gort Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>